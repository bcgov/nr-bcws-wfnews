import { Component, EventEmitter, HostBinding, Input, Output } from "@angular/core";
import { NavigationEnd } from "@angular/router";
import { BaseComponent } from "../base.component";
import { animate, state, style, transition, trigger } from '@angular/animations';
import { applicationMetrics } from '../../application.metrics';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/material/tooltip";
import * as i3 from "@angular/router";
import * as i4 from "../wf-icon/wf-icon.component";
export class WfMenuComponent extends BaseComponent {
    constructor() {
        super();
        this.activeItemChanged = new EventEmitter();
        this.tooltipShowDelay = 300;
        this.activeItemChanged.subscribe((item) => {
            if (item.menuStateAfterActive && this.config && this.config.device != "desktop") {
                this.menuState = item.menuStateAfterActive;
            }
        });
    }
    set menuItems(m) {
        this._menu = m;
        this._menu.forEach(i => i.OnActiveChanged(() => {
            this.activeItemChanged.emit(i);
        }));
    }
    get menuItems() { return this._menu; }
    get animation() {
        return this.menuState;
    }
    get isHidden() { return this.menuState == 'hidden'; }
    get isCollapsed() { return this.menuState == 'collapsed'; }
    get isExpanded() { return this.menuState == 'expanded'; }
    get toggleTitle() {
        if (this.config.device == 'desktop') {
            if (this.menuState == 'expanded')
                return 'Collapse';
            if (this.menuState == 'collapsed')
                return 'Expand';
        }
        else if (this.config.device == 'mobile') {
            if (this.menuState == 'expanded')
                return 'Hide';
        }
    }
    onToggleClick() {
        if (this.config.device == 'desktop') {
            this.menuState = this.menuState == 'expanded' ? 'collapsed' : 'expanded';
        }
        else if (this.config.device == 'mobile') {
            this.menuState = this.menuState == 'expanded' ? 'hidden' : 'expanded';
        }
    }
    onItemClick(item) {
        this.activeItemChanged.emit(item);
    }
}
WfMenuComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: WfMenuComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
WfMenuComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: WfMenuComponent, selector: "wf-menu", inputs: { menuItems: "menuItems" }, outputs: { activeItemChanged: "activeItemChanged" }, host: { properties: { "@menu-collapsed-expanded": "this.animation" } }, usesInheritance: true, ngImport: i0, template: "<div class=\"header\">\n    <div class=\"application-title\">\n        <span class=\"title\">{{ title }}</span>\n        <span class=\"environment\">{{ environment }}</span>\n    </div>\n</div>\n\n<div class=\"body\">\n    <div class=\"nav-items\">\n        <ng-container *ngFor=\"let item of menuItems\">\n            <ng-container *ngIf=\"item.type == 'router-link'\">\n                <a class=\"nav-item\"\n                    [routerLink]=\"item.route\"\n                    [class.active]=\"item.isActive\"\n                    [class.indented]=\"item.indented\"\n                    [matTooltip]=\"item.title\"\n                    [matTooltipDisabled]=\"isExpanded\"\n                    [matTooltipShowDelay]=\"tooltipShowDelay\"\n                    matTooltipClass=\"wf-menu-tooltip\"\n                    matTooltipPosition=\"right\"\n                    (click)=\"onItemClick( item )\"\n                >\n                    <wf-icon\n                        [iconName]=\"item.iconName\"\n                        iconSize=\"small\"\n                    ></wf-icon>\n                    <span class=\"label\">{{ item.title }}</span>\n                </a>\n            </ng-container>\n        </ng-container>\n    </div>\n</div>\n\n<div class=\"footer\">\n    <div class=\"toggle-button\" (click)=\"onToggleClick()\">\n        <wf-icon\n            iconName=\"double_arrow\"\n            [title]=\"toggleTitle\"\n            iconSize=\"small\"\n        ></wf-icon>\n    </div>\n\n    <div class=\"system-and-user-info\">\n        <div class=\"userNameWrapper\">\n            <wf-icon\n                iconName=\"account_circle\"\n                iconSize=\"small\"\n            ></wf-icon>\n            <span class=\"userName\">{{ userName }}</span>\n        </div>\n        <div *ngIf=\"actingOnBehalfOf\" class=\"actingOnBehalfOfWrapper\">\n            <span class=\"actingOnBehalfOf\">Acting on behalf of:</span>\n            <span>{{ actingOnBehalfOf }}</span>\n        </div>\n    </div>\n\n    <div class=\"version\">\n        <div class=\"short\" [title]=\"'Version ' + version.long\">v{{ version.short }}</div>\n        <div class=\"long\">Version {{ version.long }}</div>\n    </div>\n\n    <ng-container>\n        <ng-content select=[menu-footer]></ng-content>\n    </ng-container>\n</div>\n", styles: [":host-context(.menu-hidden){display:none}:host-context(.menu-collapsed) .body .nav-items a.nav-item.indented{padding-left:20px}:host-context(.menu-collapsed) .body .nav-items a.nav-item .label{display:none}:host-context(.menu-expanded) .body .nav-items a.nav-item{padding-right:var(--wf-gutter)}:host-context(.menu-expanded) .body .nav-items a.nav-item.indented{padding-left:50px}:host{background-color:var(--wf-menu-background-color);display:flex;flex-direction:column;justify-content:stretch;align-items:stretch;height:100%}:host .header{display:none}:host .body{flex-grow:1;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;height:100%;min-height:0}:host .body .nav-items{overflow-x:hidden;overflow-y:auto;height:100%}:host .body .nav-items a.nav-item{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;font-size:16px;padding-left:12px;text-decoration:none;cursor:pointer;height:var(--wf-menu-item-row-height)}:host .body .nav-items a.nav-item wf-icon{color:var(--wf-menu-icon-color)}:host .body .nav-items a.nav-item .label{margin-left:10px;color:var(--wf-menu-color);min-width:200px}:host .body .nav-items a.nav-item:hover{background:var(--wf-menu-highlight-background-color);font-weight:var(--wf-menu-active-font-weight)}:host .body .nav-items a.nav-item.active{font-weight:var(--wf-menu-active-font-weight);color:var(--wf-menu-active-color);background:var(--wf-menu-active-background-color)}:host .body .nav-items a.nav-item.active .label{color:var(--wf-header-background-color)}:host .footer{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center}:host .footer .toggle-button{position:absolute;cursor:pointer}:host .footer .toggle-button:hover{background:var(--wf-menu-highlight-background-color);outline:8px solid var(--wf-menu-highlight-background-color)}:host .footer .system-and-user-info{display:none}:host .footer .version{color:#454545;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:13px}:host-context(.device-desktop) .body{padding-top:14px}:host-context(.device-desktop) .footer .toggle-button{right:13px;bottom:13px}:host-context(.device-desktop.menu-collapsed) .version{height:35px;padding-bottom:32px}:host-context(.device-desktop.menu-collapsed) .version .long{display:none}:host-context(.device-desktop.menu-expanded) .footer .toggle-button{transform:scaleX(-1)}:host-context(.device-desktop.menu-expanded) .footer .version{height:48px}:host-context(.device-desktop.menu-expanded) .footer .version .short{display:none}:host-context(.device-mobile) .header{display:flex;flex-direction:column;align-items:center;border-bottom:1px solid #ddd;padding-top:5px;padding-bottom:5px}:host-context(.device-mobile) .header .application-title{display:flex;justify-content:center;align-items:flex-start;position:relative}:host-context(.device-mobile) .header .application-title .title{font-size:18px;white-space:nowrap}:host-context(.device-mobile) .header .application-title .environment{position:absolute;top:-23px;right:0;font-size:12px;color:var(--wf-header-environment-color)}:host-context(.device-mobile) .footer .toggle-button{display:none}:host-context(.device-mobile) .footer .system-and-user-info{display:flex;flex-direction:column;justify-content:center;align-items:center;white-space:normal;border-bottom:1px solid #ddd;min-height:32px;height:unset;padding:0 var(--wf-gutter);width:calc(100% - var(--wf-gutter) * 2)}:host-context(.device-mobile) .footer .system-and-user-info .userNameWrapper{display:flex;justify-content:flex-end}:host-context(.device-mobile) .footer .system-and-user-info .actingOnBehalfOfWrapper{display:flex;flex-direction:column;justify-content:center;align-items:center;white-space:normal;font-size:13px}:host-context(.device-mobile) .footer .system-and-user-info wf-icon{margin-right:6px}:host-context(.device-mobile) .footer .version{height:32px}:host-context(.device-mobile) .footer .version .short{display:none}::ng-deep .mat-tooltip-panel .mat-tooltip.wf-menu-tooltip{background-color:gray;color:#fff!important;padding:8px;font-size:15px}\n"], dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.MatTooltip, selector: "[matTooltip]", exportAs: ["matTooltip"] }, { kind: "directive", type: i3.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "component", type: i4.WfIconComponent, selector: "wf-icon", inputs: ["iconName", "iconSize"] }], animations: [
        trigger('menu-collapsed-expanded', [
            state('collapsed', style({
                'width': applicationMetrics[0].variables['--wf-menu-collapsed-width']
            })),
            state('expanded', style({
                'width': applicationMetrics[0].variables['--wf-menu-expanded-width']
            })),
            transition('collapsed => expanded', [
                animate('0.25s')
            ]),
            transition('expanded => collapsed', [
                animate('0.25s')
            ])
        ]),
        trigger('label-collapsed-expanded', [
            state('collapsed', style({
                'opacity': '0'
            })),
            state('expanded', style({
                'opacity': '1'
            })),
            transition('collapsed => expanded', [
                animate('0.25s')
            ]),
            transition('expanded => collapsed', [
                animate('0.25s')
            ])
        ])
    ] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: WfMenuComponent, decorators: [{
            type: Component,
            args: [{ selector: 'wf-menu', animations: [
                        trigger('menu-collapsed-expanded', [
                            state('collapsed', style({
                                'width': applicationMetrics[0].variables['--wf-menu-collapsed-width']
                            })),
                            state('expanded', style({
                                'width': applicationMetrics[0].variables['--wf-menu-expanded-width']
                            })),
                            transition('collapsed => expanded', [
                                animate('0.25s')
                            ]),
                            transition('expanded => collapsed', [
                                animate('0.25s')
                            ])
                        ]),
                        trigger('label-collapsed-expanded', [
                            state('collapsed', style({
                                'opacity': '0'
                            })),
                            state('expanded', style({
                                'opacity': '1'
                            })),
                            transition('collapsed => expanded', [
                                animate('0.25s')
                            ]),
                            transition('expanded => collapsed', [
                                animate('0.25s')
                            ])
                        ])
                    ], template: "<div class=\"header\">\n    <div class=\"application-title\">\n        <span class=\"title\">{{ title }}</span>\n        <span class=\"environment\">{{ environment }}</span>\n    </div>\n</div>\n\n<div class=\"body\">\n    <div class=\"nav-items\">\n        <ng-container *ngFor=\"let item of menuItems\">\n            <ng-container *ngIf=\"item.type == 'router-link'\">\n                <a class=\"nav-item\"\n                    [routerLink]=\"item.route\"\n                    [class.active]=\"item.isActive\"\n                    [class.indented]=\"item.indented\"\n                    [matTooltip]=\"item.title\"\n                    [matTooltipDisabled]=\"isExpanded\"\n                    [matTooltipShowDelay]=\"tooltipShowDelay\"\n                    matTooltipClass=\"wf-menu-tooltip\"\n                    matTooltipPosition=\"right\"\n                    (click)=\"onItemClick( item )\"\n                >\n                    <wf-icon\n                        [iconName]=\"item.iconName\"\n                        iconSize=\"small\"\n                    ></wf-icon>\n                    <span class=\"label\">{{ item.title }}</span>\n                </a>\n            </ng-container>\n        </ng-container>\n    </div>\n</div>\n\n<div class=\"footer\">\n    <div class=\"toggle-button\" (click)=\"onToggleClick()\">\n        <wf-icon\n            iconName=\"double_arrow\"\n            [title]=\"toggleTitle\"\n            iconSize=\"small\"\n        ></wf-icon>\n    </div>\n\n    <div class=\"system-and-user-info\">\n        <div class=\"userNameWrapper\">\n            <wf-icon\n                iconName=\"account_circle\"\n                iconSize=\"small\"\n            ></wf-icon>\n            <span class=\"userName\">{{ userName }}</span>\n        </div>\n        <div *ngIf=\"actingOnBehalfOf\" class=\"actingOnBehalfOfWrapper\">\n            <span class=\"actingOnBehalfOf\">Acting on behalf of:</span>\n            <span>{{ actingOnBehalfOf }}</span>\n        </div>\n    </div>\n\n    <div class=\"version\">\n        <div class=\"short\" [title]=\"'Version ' + version.long\">v{{ version.short }}</div>\n        <div class=\"long\">Version {{ version.long }}</div>\n    </div>\n\n    <ng-container>\n        <ng-content select=[menu-footer]></ng-content>\n    </ng-container>\n</div>\n", styles: [":host-context(.menu-hidden){display:none}:host-context(.menu-collapsed) .body .nav-items a.nav-item.indented{padding-left:20px}:host-context(.menu-collapsed) .body .nav-items a.nav-item .label{display:none}:host-context(.menu-expanded) .body .nav-items a.nav-item{padding-right:var(--wf-gutter)}:host-context(.menu-expanded) .body .nav-items a.nav-item.indented{padding-left:50px}:host{background-color:var(--wf-menu-background-color);display:flex;flex-direction:column;justify-content:stretch;align-items:stretch;height:100%}:host .header{display:none}:host .body{flex-grow:1;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;height:100%;min-height:0}:host .body .nav-items{overflow-x:hidden;overflow-y:auto;height:100%}:host .body .nav-items a.nav-item{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;font-size:16px;padding-left:12px;text-decoration:none;cursor:pointer;height:var(--wf-menu-item-row-height)}:host .body .nav-items a.nav-item wf-icon{color:var(--wf-menu-icon-color)}:host .body .nav-items a.nav-item .label{margin-left:10px;color:var(--wf-menu-color);min-width:200px}:host .body .nav-items a.nav-item:hover{background:var(--wf-menu-highlight-background-color);font-weight:var(--wf-menu-active-font-weight)}:host .body .nav-items a.nav-item.active{font-weight:var(--wf-menu-active-font-weight);color:var(--wf-menu-active-color);background:var(--wf-menu-active-background-color)}:host .body .nav-items a.nav-item.active .label{color:var(--wf-header-background-color)}:host .footer{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center}:host .footer .toggle-button{position:absolute;cursor:pointer}:host .footer .toggle-button:hover{background:var(--wf-menu-highlight-background-color);outline:8px solid var(--wf-menu-highlight-background-color)}:host .footer .system-and-user-info{display:none}:host .footer .version{color:#454545;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:13px}:host-context(.device-desktop) .body{padding-top:14px}:host-context(.device-desktop) .footer .toggle-button{right:13px;bottom:13px}:host-context(.device-desktop.menu-collapsed) .version{height:35px;padding-bottom:32px}:host-context(.device-desktop.menu-collapsed) .version .long{display:none}:host-context(.device-desktop.menu-expanded) .footer .toggle-button{transform:scaleX(-1)}:host-context(.device-desktop.menu-expanded) .footer .version{height:48px}:host-context(.device-desktop.menu-expanded) .footer .version .short{display:none}:host-context(.device-mobile) .header{display:flex;flex-direction:column;align-items:center;border-bottom:1px solid #ddd;padding-top:5px;padding-bottom:5px}:host-context(.device-mobile) .header .application-title{display:flex;justify-content:center;align-items:flex-start;position:relative}:host-context(.device-mobile) .header .application-title .title{font-size:18px;white-space:nowrap}:host-context(.device-mobile) .header .application-title .environment{position:absolute;top:-23px;right:0;font-size:12px;color:var(--wf-header-environment-color)}:host-context(.device-mobile) .footer .toggle-button{display:none}:host-context(.device-mobile) .footer .system-and-user-info{display:flex;flex-direction:column;justify-content:center;align-items:center;white-space:normal;border-bottom:1px solid #ddd;min-height:32px;height:unset;padding:0 var(--wf-gutter);width:calc(100% - var(--wf-gutter) * 2)}:host-context(.device-mobile) .footer .system-and-user-info .userNameWrapper{display:flex;justify-content:flex-end}:host-context(.device-mobile) .footer .system-and-user-info .actingOnBehalfOfWrapper{display:flex;flex-direction:column;justify-content:center;align-items:center;white-space:normal;font-size:13px}:host-context(.device-mobile) .footer .system-and-user-info wf-icon{margin-right:6px}:host-context(.device-mobile) .footer .version{height:32px}:host-context(.device-mobile) .footer .version .short{display:none}::ng-deep .mat-tooltip-panel .mat-tooltip.wf-menu-tooltip{background-color:gray;color:#fff!important;padding:8px;font-size:15px}\n"] }]
        }], ctorParameters: function () { return []; }, propDecorators: { menuItems: [{
                type: Input
            }], activeItemChanged: [{
                type: Output
            }], animation: [{
                type: HostBinding,
                args: ['@menu-collapsed-expanded']
            }] } });
export class RouterLink {
    constructor(title, route, iconName, menuStateAfterActive = 'collapsed', router, routerLinkExactMatch = true, indented = false) {
        this.title = title;
        this.route = route;
        this.iconName = iconName;
        this.menuStateAfterActive = menuStateAfterActive;
        this.router = router;
        this.routerLinkExactMatch = routerLinkExactMatch;
        this.indented = indented;
        this.type = 'router-link';
        this.active = false;
        this.activeChangedCallback = () => { };
        this.setActive(this.router.isActive(this.route, this.routerLinkExactMatch));
        router.events.subscribe(event => {
            if (event instanceof NavigationEnd) {
                this.setActive(this.router.isActive(this.route, this.routerLinkExactMatch));
            }
        });
    }
    get isActive() {
        return this.active;
    }
    setActive(active) {
        if (active == this.active)
            return;
        this.active = active;
        if (this.active)
            this.activeChangedCallback();
    }
    OnActiveChanged(cb) {
        this.activeChangedCallback = cb;
    }
}
export class ActionTrigger {
    constructor(title, iconName = null, menuStateAfterActive = 'collapsed', indented = false) {
        this.title = title;
        this.iconName = iconName;
        this.menuStateAfterActive = menuStateAfterActive;
        this.indented = indented;
        this.type = 'action-trigger';
        this.actionTriggered = new EventEmitter();
    }
    OnActiveChanged(cb) { }
    onClick() {
        this.actionTriggered.emit(this);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2YtbWVudS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy93ZmNjLWFwcGxpY2F0aW9uLXVpL3NyYy9hcHBsaWNhdGlvbi9jb21wb25lbnRzL3dmLW1lbnUvd2YtbWVudS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy93ZmNjLWFwcGxpY2F0aW9uLXVpL3NyYy9hcHBsaWNhdGlvbi9jb21wb25lbnRzL3dmLW1lbnUvd2YtbWVudS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNwRixPQUFPLEVBQUUsYUFBYSxFQUFtQixNQUFNLGlCQUFpQixDQUFDO0FBRWpFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2pGLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDOzs7Ozs7QUFzQy9ELE1BQU0sT0FBTyxlQUFnQixTQUFRLGFBQWE7SUFrQjlDO1FBQ0ksS0FBSyxFQUFFLENBQUE7UUFURCxzQkFBaUIsR0FBRyxJQUFJLFlBQVksRUFBYyxDQUFDO1FBTTdELHFCQUFnQixHQUFHLEdBQUcsQ0FBQTtRQUlsQixJQUFJLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFFLENBQUUsSUFBSSxFQUFHLEVBQUU7WUFDekMsSUFBSyxJQUFJLENBQUMsb0JBQW9CLElBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sSUFBSSxTQUFTLEVBQUM7Z0JBQzdFLElBQUksQ0FBQyxT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QUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLG9CQUFvQixDQUFFLENBQUUsQ0FBQTthQUNsRjtRQUNMLENBQUMsQ0FBRSxDQUFBO0lBQ1AsQ0FBQztJQUVELElBQUksUUFBUTtRQUNSLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQTtJQUN0QixDQUFDO0lBRUQsU0FBUyxDQUFFLE1BQWU7UUFDdEIsSUFBSyxNQUFNLElBQUksSUFBSSxDQUFDLE1BQU07WUFBRyxPQUFNO1FBQ25DLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO1FBQ3BCLElBQUssSUFBSSxDQUFDLE1BQU07WUFDWixJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQTtJQUNwQyxDQUFDO0lBRUQsZUFBZSxDQUFFLEVBQWM7UUFDM0IsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEVBQUUsQ0FBQTtJQUNuQyxDQUFDO0NBQ0o7QUFFRCxNQUFNLE9BQU8sYUFBYTtJQUt0QixZQUNXLEtBQWEsRUFDYixXQUFtQixJQUFJLEVBQ3ZCLHVCQUFvQyxXQUFXLEVBQy9DLFdBQVcsS0FBSztRQUhoQixVQUFLLEdBQUwsS0FBSyxDQUFRO1FBQ2IsYUFBUSxHQUFSLFFBQVEsQ0FBZTtRQUN2Qix5QkFBb0IsR0FBcEIsb0JBQW9CLENBQTJCO1FBQy9DLGFBQVEsR0FBUixRQUFRLENBQVE7UUFSbEIsU0FBSSxHQUFHLGdCQUFnQixDQUFBO1FBRWhDLG9CQUFlLEdBQUcsSUFBSSxZQUFZLEVBQWlCLENBQUM7SUFRcEQsQ0FBQztJQUVELGVBQWUsQ0FBRSxFQUFjLElBQUksQ0FBQztJQUVwQyxPQUFPO1FBQ0gsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDbkMsQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEhvc3RCaW5kaW5nLCBJbnB1dCwgT3V0cHV0IH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IE5hdmlnYXRpb25FbmQsIFJvdXRlciwgVXJsVHJlZSB9IGZyb20gXCJAYW5ndWxhci9yb3V0ZXJcIjtcbmltcG9ydCB7IFdmTWVudVN0YXRlIH0gZnJvbSBcIi4uLy4uL2FwcGxpY2F0aW9uLmNvbmZpZ1wiO1xuaW1wb3J0IHsgQmFzZUNvbXBvbmVudCB9IGZyb20gXCIuLi9iYXNlLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgYW5pbWF0ZSwgc3RhdGUsIHN0eWxlLCB0cmFuc2l0aW9uLCB0cmlnZ2VyIH0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5pbXBvcnQgeyBhcHBsaWNhdGlvbk1ldHJpY3MgfSBmcm9tICcuLi8uLi9hcHBsaWNhdGlvbi5tZXRyaWNzJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICd3Zi1tZW51JyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vd2YtbWVudS5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vd2YtbWVudS5jb21wb25lbnQuc2NzcyddLFxuICAgIGFuaW1hdGlvbnM6IFtcbiAgICAgICAgdHJpZ2dlciggJ21lbnUtY29sbGFwc2VkLWV4cGFuZGVkJywgW1xuICAgICAgICAgICAgc3RhdGUoICdjb2xsYXBzZWQnLCBzdHlsZSgge1xuICAgICAgICAgICAgICAgICd3aWR0aCc6IGFwcGxpY2F0aW9uTWV0cmljc1sgMCBdLnZhcmlhYmxlc1sgJy0td2YtbWVudS1jb2xsYXBzZWQtd2lkdGgnIF1cbiAgICAgICAgICAgIH0gKSApLFxuICAgICAgICAgICAgc3RhdGUoICdleHBhbmRlZCcsIHN0eWxlKCB7XG4gICAgICAgICAgICAgICAgJ3dpZHRoJzogYXBwbGljYXRpb25NZXRyaWNzWyAwIF0udmFyaWFibGVzWyAnLS13Zi1tZW51LWV4cGFuZGVkLXdpZHRoJyBdXG4gICAgICAgICAgICB9ICkgKSxcbiAgICAgICAgICAgIHRyYW5zaXRpb24oICdjb2xsYXBzZWQgPT4gZXhwYW5kZWQnLCBbXG4gICAgICAgICAgICAgICAgYW5pbWF0ZSggJzAuMjVzJyApXG4gICAgICAgICAgICBdICksXG4gICAgICAgICAgICB0cmFuc2l0aW9uKCAnZXhwYW5kZWQgPT4gY29sbGFwc2VkJywgW1xuICAgICAgICAgICAgICAgIGFuaW1hdGUoICcwLjI1cycgKVxuICAgICAgICAgICAgXSApXG4gICAgICAgIF0gKSxcbiAgICAgICAgdHJpZ2dlciggJ2xhYmVsLWNvbGxhcHNlZC1leHBhbmRlZCcsIFtcbiAgICAgICAgICAgIHN0YXRlKCAnY29sbGFwc2VkJywgc3R5bGUoIHtcbiAgICAgICAgICAgICAgICAnb3BhY2l0eSc6ICcwJ1xuICAgICAgICAgICAgfSApICksXG4gICAgICAgICAgICBzdGF0ZSggJ2V4cGFuZGVkJywgc3R5bGUoIHtcbiAgICAgICAgICAgICAgICAnb3BhY2l0eSc6ICcxJ1xuICAgICAgICAgICAgfSApICksXG4gICAgICAgICAgICB0cmFuc2l0aW9uKCAnY29sbGFwc2VkID0+IGV4cGFuZGVkJywgW1xuICAgICAgICAgICAgICAgIGFuaW1hdGUoICcwLjI1cycgKVxuICAgICAgICAgICAgXSApLFxuICAgICAgICAgICAgdHJhbnNpdGlvbiggJ2V4cGFuZGVkID0+IGNvbGxhcHNlZCcsIFtcbiAgICAgICAgICAgICAgICBhbmltYXRlKCAnMC4yNXMnIClcbiAgICAgICAgICAgIF0gKVxuICAgICAgICBdIClcblxuICAgIF1cbn0pXG5leHBvcnQgY2xhc3MgV2ZNZW51Q29tcG9uZW50IGV4dGVuZHMgQmFzZUNvbXBvbmVudCB7XG4gICAgX21lbnU6IFdmTWVudUl0ZW1zXG4gICAgQElucHV0KCkgc2V0IG1lbnVJdGVtcyggbTogV2ZNZW51SXRlbXMgKSB7XG4gICAgICAgIHRoaXMuX21lbnUgPSBtXG4gICAgICAgIHRoaXMuX21lbnUuZm9yRWFjaCggaSA9PiBpLk9uQWN0aXZlQ2hhbmdlZCggKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVJdGVtQ2hhbmdlZC5lbWl0KCBpIClcbiAgICAgICAgfSApIClcbiAgICB9XG4gICAgZ2V0IG1lbnVJdGVtcygpIHsgcmV0dXJuIHRoaXMuX21lbnUgfVxuXG4gICAgQE91dHB1dCgpIGFjdGl2ZUl0ZW1DaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcjxXZk1lbnVJdGVtPigpO1xuXG4gICAgQEhvc3RCaW5kaW5nKCAnQG1lbnUtY29sbGFwc2VkLWV4cGFuZGVkJyApIGdldCBhbmltYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lbnVTdGF0ZVxuICAgIH1cblxuICAgIHRvb2x0aXBTaG93RGVsYXkgPSAzMDBcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpXG4gICAgICAgIHRoaXMuYWN0aXZlSXRlbUNoYW5nZWQuc3Vic2NyaWJlKCAoIGl0ZW0gKSA9PiB7XG4gICAgICAgICAgICBpZiAoIGl0ZW0ubWVudVN0YXRlQWZ0ZXJBY3RpdmUgJiYgdGhpcy5jb25maWcgJiYgdGhpcy5jb25maWcuZGV2aWNlICE9IFwiZGVza3RvcFwiKXtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnVTdGF0ZSA9IGl0ZW0ubWVudVN0YXRlQWZ0ZXJBY3RpdmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSApXG4gICAgfVxuXG4gICAgZ2V0IGlzSGlkZGVuKCkgeyByZXR1cm4gdGhpcy5tZW51U3RhdGUgPT0gJ2hpZGRlbicgfVxuICAgIGdldCBpc0NvbGxhcHNlZCgpIHsgcmV0dXJuIHRoaXMubWVudVN0YXRlID09ICdjb2xsYXBzZWQnIH1cbiAgICBnZXQgaXNFeHBhbmRlZCgpIHsgcmV0dXJuIHRoaXMubWVudVN0YXRlID09ICdleHBhbmRlZCcgfVxuXG4gICAgZ2V0IHRvZ2dsZVRpdGxlKCkge1xuICAgICAgICBpZiAoIHRoaXMuY29uZmlnLmRldmljZSA9PSAnZGVza3RvcCcgKSB7XG4gICAgICAgICAgICBpZiAoIHRoaXMubWVudVN0YXRlID09ICdleHBhbmRlZCcgKSByZXR1cm4gJ0NvbGxhcHNlJ1xuICAgICAgICAgICAgaWYgKCB0aGlzLm1lbnVTdGF0ZSA9PSAnY29sbGFwc2VkJyApIHJldHVybiAnRXhwYW5kJ1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCB0aGlzLmNvbmZpZy5kZXZpY2UgPT0gJ21vYmlsZScgKSB7XG4gICAgICAgICAgICBpZiAoIHRoaXMubWVudVN0YXRlID09ICdleHBhbmRlZCcgKSByZXR1cm4gJ0hpZGUnXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvblRvZ2dsZUNsaWNrKCkge1xuICAgICAgICBpZiAoIHRoaXMuY29uZmlnLmRldmljZSA9PSAnZGVza3RvcCcgKSB7XG4gICAgICAgICAgICB0aGlzLm1lbnVTdGF0ZSA9IHRoaXMubWVudVN0YXRlID09ICdleHBhbmRlZCcgPyAnY29sbGFwc2VkJyA6ICdleHBhbmRlZCdcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICggdGhpcy5jb25maWcuZGV2aWNlID09ICdtb2JpbGUnICkge1xuICAgICAgICAgICAgdGhpcy5tZW51U3RhdGUgPSB0aGlzLm1lbnVTdGF0ZSA9PSAnZXhwYW5kZWQnID8gJ2hpZGRlbicgOiAnZXhwYW5kZWQnXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkl0ZW1DbGljayggaXRlbTogV2ZNZW51SXRlbSApIHtcbiAgICAgICAgdGhpcy5hY3RpdmVJdGVtQ2hhbmdlZC5lbWl0KCBpdGVtIClcbiAgICB9XG59XG5cbi8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cbmV4cG9ydCB0eXBlIFdmTWVudUl0ZW0gPSBSb3V0ZXJMaW5rfEFjdGlvblRyaWdnZXJcbmV4cG9ydCB0eXBlIFdmTWVudUl0ZW1zID0gQXJyYXk8V2ZNZW51SXRlbT5cblxuZXhwb3J0IGNsYXNzIFJvdXRlckxpbmt7XG4gICAgcmVhZG9ubHkgdHlwZSA9ICdyb3V0ZXItbGluaydcblxuICAgIHByaXZhdGUgYWN0aXZlOiBib29sZWFuID0gZmFsc2VcbiAgICBwcml2YXRlIGFjdGl2ZUNoYW5nZWRDYWxsYmFjazogKCkgPT4gdm9pZCA9ICgpID0+IHt9XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIHRpdGxlOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyByb3V0ZTogc3RyaW5nfFVybFRyZWUsXG4gICAgICAgIHB1YmxpYyBpY29uTmFtZTogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgbWVudVN0YXRlQWZ0ZXJBY3RpdmU6IFdmTWVudVN0YXRlID0gJ2NvbGxhcHNlZCcsXG4gICAgICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXG4gICAgICAgIHB1YmxpYyByb3V0ZXJMaW5rRXhhY3RNYXRjaDpib29sZWFuID0gIHRydWUsXG4gICAgICAgIHB1YmxpYyBpbmRlbnRlZCA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHRoaXMuc2V0QWN0aXZlKCB0aGlzLnJvdXRlci5pc0FjdGl2ZSggdGhpcy5yb3V0ZSwgdGhpcy5yb3V0ZXJMaW5rRXhhY3RNYXRjaCApIClcblxuICAgICAgICByb3V0ZXIuZXZlbnRzLnN1YnNjcmliZSggZXZlbnQgPT4ge1xuICAgICAgICAgICAgaWYgKCBldmVudCBpbnN0YW5jZW9mIE5hdmlnYXRpb25FbmQgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmUoIHRoaXMucm91dGVyLmlzQWN0aXZlKCB0aGlzLnJvdXRlLCB0aGlzLnJvdXRlckxpbmtFeGFjdE1hdGNoICkgKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IClcbiAgICB9XG5cbiAgICBnZXQgaXNBY3RpdmUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZVxuICAgIH1cblxuICAgIHNldEFjdGl2ZSggYWN0aXZlOiBib29sZWFuICkge1xuICAgICAgICBpZiAoIGFjdGl2ZSA9PSB0aGlzLmFjdGl2ZSApIHJldHVyblxuICAgICAgICB0aGlzLmFjdGl2ZSA9IGFjdGl2ZVxuICAgICAgICBpZiAoIHRoaXMuYWN0aXZlIClcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2hhbmdlZENhbGxiYWNrKClcbiAgICB9XG5cbiAgICBPbkFjdGl2ZUNoYW5nZWQoIGNiOiAoKSA9PiB2b2lkICkge1xuICAgICAgICB0aGlzLmFjdGl2ZUNoYW5nZWRDYWxsYmFjayA9IGNiXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWN0aW9uVHJpZ2dlciB7XG4gICAgcmVhZG9ubHkgdHlwZSA9ICdhY3Rpb24tdHJpZ2dlcidcblxuICAgIGFjdGlvblRyaWdnZXJlZCA9IG5ldyBFdmVudEVtaXR0ZXI8QWN0aW9uVHJpZ2dlcj4oKTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcbiAgICAgICAgcHVibGljIGljb25OYW1lOiBzdHJpbmcgPSBudWxsLFxuICAgICAgICBwdWJsaWMgbWVudVN0YXRlQWZ0ZXJBY3RpdmU6IFdmTWVudVN0YXRlID0gJ2NvbGxhcHNlZCcsXG4gICAgICAgIHB1YmxpYyBpbmRlbnRlZCA9IGZhbHNlXG4gICAgKSB7XG4gICAgfVxuXG4gICAgT25BY3RpdmVDaGFuZ2VkKCBjYjogKCkgPT4gdm9pZCApIHt9XG5cbiAgICBvbkNsaWNrKCkge1xuICAgICAgICB0aGlzLmFjdGlvblRyaWdnZXJlZC5lbWl0KHRoaXMpXG4gICAgfVxufVxuXG4iLCI8ZGl2IGNsYXNzPVwiaGVhZGVyXCI+XG4gICAgPGRpdiBjbGFzcz1cImFwcGxpY2F0aW9uLXRpdGxlXCI+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwidGl0bGVcIj57eyB0aXRsZSB9fTwvc3Bhbj5cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJlbnZpcm9ubWVudFwiPnt7IGVudmlyb25tZW50IH19PC9zcGFuPlxuICAgIDwvZGl2PlxuPC9kaXY+XG5cbjxkaXYgY2xhc3M9XCJib2R5XCI+XG4gICAgPGRpdiBjbGFzcz1cIm5hdi1pdGVtc1wiPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBpdGVtIG9mIG1lbnVJdGVtc1wiPlxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIml0ZW0udHlwZSA9PSAncm91dGVyLWxpbmsnXCI+XG4gICAgICAgICAgICAgICAgPGEgY2xhc3M9XCJuYXYtaXRlbVwiXG4gICAgICAgICAgICAgICAgICAgIFtyb3V0ZXJMaW5rXT1cIml0ZW0ucm91dGVcIlxuICAgICAgICAgICAgICAgICAgICBbY2xhc3MuYWN0aXZlXT1cIml0ZW0uaXNBY3RpdmVcIlxuICAgICAgICAgICAgICAgICAgICBbY2xhc3MuaW5kZW50ZWRdPVwiaXRlbS5pbmRlbnRlZFwiXG4gICAgICAgICAgICAgICAgICAgIFttYXRUb29sdGlwXT1cIml0ZW0udGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICBbbWF0VG9vbHRpcERpc2FibGVkXT1cImlzRXhwYW5kZWRcIlxuICAgICAgICAgICAgICAgICAgICBbbWF0VG9vbHRpcFNob3dEZWxheV09XCJ0b29sdGlwU2hvd0RlbGF5XCJcbiAgICAgICAgICAgICAgICAgICAgbWF0VG9vbHRpcENsYXNzPVwid2YtbWVudS10b29sdGlwXCJcbiAgICAgICAgICAgICAgICAgICAgbWF0VG9vbHRpcFBvc2l0aW9uPVwicmlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAoY2xpY2spPVwib25JdGVtQ2xpY2soIGl0ZW0gKVwiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8d2YtaWNvblxuICAgICAgICAgICAgICAgICAgICAgICAgW2ljb25OYW1lXT1cIml0ZW0uaWNvbk5hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvblNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgID48L3dmLWljb24+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibGFiZWxcIj57eyBpdGVtLnRpdGxlIH19PC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8L2Rpdj5cbjwvZGl2PlxuXG48ZGl2IGNsYXNzPVwiZm9vdGVyXCI+XG4gICAgPGRpdiBjbGFzcz1cInRvZ2dsZS1idXR0b25cIiAoY2xpY2spPVwib25Ub2dnbGVDbGljaygpXCI+XG4gICAgICAgIDx3Zi1pY29uXG4gICAgICAgICAgICBpY29uTmFtZT1cImRvdWJsZV9hcnJvd1wiXG4gICAgICAgICAgICBbdGl0bGVdPVwidG9nZ2xlVGl0bGVcIlxuICAgICAgICAgICAgaWNvblNpemU9XCJzbWFsbFwiXG4gICAgICAgID48L3dmLWljb24+XG4gICAgPC9kaXY+XG5cbiAgICA8ZGl2IGNsYXNzPVwic3lzdGVtLWFuZC11c2VyLWluZm9cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInVzZXJOYW1lV3JhcHBlclwiPlxuICAgICAgICAgICAgPHdmLWljb25cbiAgICAgICAgICAgICAgICBpY29uTmFtZT1cImFjY291bnRfY2lyY2xlXCJcbiAgICAgICAgICAgICAgICBpY29uU2l6ZT1cInNtYWxsXCJcbiAgICAgICAgICAgID48L3dmLWljb24+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cInVzZXJOYW1lXCI+e3sgdXNlck5hbWUgfX08L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2ICpuZ0lmPVwiYWN0aW5nT25CZWhhbGZPZlwiIGNsYXNzPVwiYWN0aW5nT25CZWhhbGZPZldyYXBwZXJcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiYWN0aW5nT25CZWhhbGZPZlwiPkFjdGluZyBvbiBiZWhhbGYgb2Y6PC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4+e3sgYWN0aW5nT25CZWhhbGZPZiB9fTwvc3Bhbj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG5cbiAgICA8ZGl2IGNsYXNzPVwidmVyc2lvblwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwic2hvcnRcIiBbdGl0bGVdPVwiJ1ZlcnNpb24gJyArIHZlcnNpb24ubG9uZ1wiPnZ7eyB2ZXJzaW9uLnNob3J0IH19PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJsb25nXCI+VmVyc2lvbiB7eyB2ZXJzaW9uLmxvbmcgfX08L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxuZy1jb250YWluZXI+XG4gICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1bbWVudS1mb290ZXJdPjwvbmctY29udGVudD5cbiAgICA8L25nLWNvbnRhaW5lcj5cbjwvZGl2PlxuIl19